<section class="page-wrap">
  <div class="container">
    <div class="hero">
      <h1 class="title-font">Cadastrar Pet</h1>
      <p class="subtitle">Insira as informa√ß√µes do seu pet.</p>
      <div class="emoji">üß°üêæüíö</div>
    </div>

    <mat-card class="card-elevated form-card">
      <!-- upload foto -->
      <div class="photo">
        <input
          #fileInput
          type="file"
          accept="image/*"
          hidden
          (change)="onFileSelected($event)"
        />

        <button type="button" class="photo__circle" (click)="fileInput.click()">
          <ng-container *ngIf="photoPreview; else noPhoto">
            <img [src]="photoPreview" alt="Foto do pet" />
          </ng-container>

          <ng-template #noPhoto>
            <mat-icon>photo_camera</mat-icon>
          </ng-template>
        </button>

        <button
          type="button"
          class="photo__plus"
          (click)="fileInput.click()"
          aria-label="Adicionar foto"
        >
          <mat-icon>add</mat-icon>
        </button>

        <div class="photo__label">Enviar foto do pet</div>
      </div>

      <form class="grid" [formGroup]="form" (ngSubmit)="save()">
        <!-- DADOS PRINCIPAIS -->
        <mat-form-field appearance="outline" class="full">
          <mat-label>Nome do Pet</mat-label>
          <input matInput placeholder="Ex: Bolinha" formControlName="name" />
          <mat-error *ngIf="name.touched && name.invalid">Nome √© obrigat√≥rio.</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full">
          <mat-label>Esp√©cie</mat-label>
          <mat-select formControlName="species" placeholder="Selecione...">
            <mat-option *ngFor="let opt of speciesOptions" [value]="opt.value">
              {{ opt.label }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="species.touched && species.invalid">Esp√©cie √© obrigat√≥ria.</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Ra√ßa</mat-label>
          <input matInput placeholder="Ex: Poodle" formControlName="breed" />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Idade</mat-label>
          <input matInput type="number" placeholder="Ex: 3" formControlName="ageYears" />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Peso (kg)</mat-label>
          <input matInput type="number" placeholder="Ex: 8.5" formControlName="weightKg" />
        </mat-form-field>

        <div class="sex">
          <div class="sex__label">Sexo</div>
          <div class="sex__buttons">
            <button
              type="button"
              class="sex-btn"
              [class.active]="form.value.sex === 'M'"
              (click)="setSex('M')"
            >
              ‚ôÇ Macho
            </button>
            <button
              type="button"
              class="sex-btn"
              [class.active]="form.value.sex === 'F'"
              (click)="setSex('F')"
            >
              ‚ôÄ F√™mea
            </button>
          </div>
        </div>

        <mat-form-field appearance="outline" class="full">
          <mat-label>Data da √öltima Vacina</mat-label>
          <input
            matInput
            [matDatepicker]="picker"
            placeholder="mm/dd/yyyy"
            formControlName="lastVaccineDate"
          />
          <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="outline" class="span-2">
          <mat-label>Observa√ß√µes</mat-label>
          <textarea
            matInput
            rows="4"
            placeholder="Informa√ß√µes adicionais sobre o pet..."
            formControlName="notes"
          ></textarea>
        </mat-form-field>

        <!-- ‚úÖ NOVO: INFORMA√á√ïES ADICIONAIS -->
        <div class="additional span-2" formGroupName="additionalInfo">
          <div class="additional__title title-font">üíú Informa√ß√µes Adicionais</div>

          <div class="additional__grid">
            <mat-form-field appearance="outline">
              <mat-label>Tutor Respons√°vel</mat-label>
              <input matInput placeholder="Ex: Ana Paula Santos" formControlName="ownerName" />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Porte</mat-label>
              <mat-select placeholder="Selecione..." formControlName="size">
                <mat-option value="Pequeno">Pequeno</mat-option>
                <mat-option value="M√©dio">M√©dio</mat-option>
                <mat-option value="Grande">Grande</mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Castrado</mat-label>
              <mat-select placeholder="Selecione..." formControlName="neutered">
                <mat-option [value]="true">Sim</mat-option>
                <mat-option [value]="false">N√£o</mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Pelagem</mat-label>
              <input matInput placeholder="Ex: Longa e dourada" formControlName="coat" />
            </mat-form-field>

            <mat-form-field appearance="outline" class="span-2">
              <mat-label>Temperamento</mat-label>
              <input matInput placeholder="Ex: D√≥cil e brincalh√£o" formControlName="temperament" />
            </mat-form-field>
          </div>
        </div>

        <!-- SA√öDE DO PET -->
        <div class="health span-2" formGroupName="health">
          <div class="health__title title-font">üíö Sa√∫de do Pet</div>

          <div class="health__grid">
            <mat-form-field appearance="outline">
              <mat-label>Alergias</mat-label>
              <input matInput placeholder="Ex: Frango, p√≥len" formControlName="allergies" />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Medicamentos</mat-label>
              <input matInput placeholder="Ex: Antiparasit√°rio" formControlName="medications" />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Restri√ß√µes</mat-label>
              <input matInput placeholder="Ex: N√£o pode correr muito" formControlName="restrictions" />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Veterin√°rio de Rotina</mat-label>
              <input matInput placeholder="Ex: Dr. Jo√£o Silva" formControlName="vetName" />
            </mat-form-field>
          </div>
        </div>

        <!-- A√á√ïES -->
        <div class="actions span-2">
          <button mat-raised-button color="primary" type="submit" class="btn-save">
            <mat-icon>check_circle</mat-icon>
            Salvar Pet
          </button>

          <button
            mat-stroked-button
            color="primary"
            type="button"
            (click)="cancel()"
            class="btn-cancel"
          >
            <mat-icon>close</mat-icon>
            Cancelar
          </button>
        </div>
      </form>
    </mat-card>

    <div class="bottom-emoji">ü¶¥üêæü¶¥</div>
  </div>
</section>
